<!-- home.html -->
<div class="Kendo-grid-container">
  <!-- Server-side paging configuration -->
  <kendo-grid 
    [data]="gridView"
    [pageSize]="gridState.take" 
    [skip]="gridState.skip" 
    [sort]="gridState.sort" 
    [filter]="gridState.filter" 
    [sortable]="true" 
    [filterable]="true" 
    [pageable]="true" 
    [loading]="loading"
    (dataStateChange)="onDataStateChange($event)" 
    [selectable]="{
      mode: 'multiple',
      metaKeyMultiSelect: requireSelectOrCtrlKeys
    }" 
    [selectedKeys]="selectedKeys" 
    (selectionChange)="onSelectionChange($event)" 
    kendoGridSelectBy="empId">

    <kendo-toolbar overflow="scroll">
      <kendo-toolbar-button kendoGridFilterTool></kendo-toolbar-button>
      <kendo-toolbar-button kendoGridSortTool></kendo-toolbar-button>
      <kendo-toolbar-button kendoGridGroupTool></kendo-toolbar-button>
      <kendo-toolbar-separator></kendo-toolbar-separator>
      <kendo-toolbar-button kendoGridColumnChooserTool></kendo-toolbar-button>
      <kendo-toolbar-spacer></kendo-toolbar-spacer>
      <kendo-toolbar-button *ngIf="!IsEmployee()" id="Delete-btn" text="Delete" (click)="onDeleteMultiple()" [disabled]="!selectedKeys.length"></kendo-toolbar-button>
      <kendo-toolbar-button *ngIf="!IsEmployee()" text="Bulk Edit" (click)="onBulkEdit()" [disabled]="!selectedKeys.length"></kendo-toolbar-button>
      <kendo-toolbar-button *ngIf="!IsEmployee()" class="import-btn" (click)="onImportExcel()" text="Import Excel"></kendo-toolbar-button>
      <!-- <kendo-toolbar-button *ngIf="!IsEmployee()" text="Add New" (click)="onAddNew()"></kendo-toolbar-button> -->
    </kendo-toolbar>

    <kendo-grid-checkbox-column [showSelectAll]="true" [width]="25"></kendo-grid-checkbox-column>

    <kendo-grid-column field="empId" title="EMP ID" [width]="70">
      <ng-template kendoGridCellTemplate let-dataItem>
        <span class="empId-cell">{{ dataItem.empId }}</span>
      </ng-template>
    </kendo-grid-column>

    <kendo-grid-column field="name" title="Name" [width]="150"></kendo-grid-column>
    <kendo-grid-column field="designation" title="Role" [width]="140"></kendo-grid-column>
    <kendo-grid-column field="project" title="Project" [width]="180"></kendo-grid-column>

    <!-- Hidden by default, available in Column Chooser -->
    <kendo-grid-column field="email" title="Email" [width]="180" [hidden]="true"></kendo-grid-column>
    <kendo-grid-column field="reportingTo" title="Reporting To" [width]="150" [hidden]="true"></kendo-grid-column>
    <kendo-grid-column field="billable" title="Billable" [width]="100" [hidden]="true"></kendo-grid-column>
    <kendo-grid-column field="skill" title="Skill" [width]="130" [hidden]="true"></kendo-grid-column>
    <kendo-grid-column field="location" title="Location" [width]="130" [hidden]="true"></kendo-grid-column>
    <kendo-grid-column field="doj" title="Date of Joining" [width]="140" [hidden]="true">
      <ng-template kendoGridCellTemplate let-dataItem>
        {{ dataItem.doj | date: 'yyyy-MM-dd' }}
      </ng-template>
    </kendo-grid-column>
    <kendo-grid-column field="remarks" title="Remarks" [width]="200" [hidden]="true"></kendo-grid-column>

    <kendo-grid-column title="Actions" [width]="150" [sortable]="false" [filterable]="false">
      <ng-template kendoGridCellTemplate let-dataItem>
        <button *ngIf="!IsEmployee()" kendoButton class="action-btn edit" (click)="onEdit(dataItem)" title="Edit">‚úèÔ∏è</button>
        <button kendoButton class="action-btn details" (click)="onMore(dataItem)" title="Details">üëÅÔ∏è</button>
        <button *ngIf="!IsEmployee()" kendoButton class="action-btn delete" (click)="onDel(dataItem.empId!)" title="Delete">üóëÔ∏è</button>
      </ng-template>
    </kendo-grid-column>
  </kendo-grid>
</div>

<!-- Bulk Edit Modal -->
<kendo-dialog *ngIf="showBulkEditModal" title="Bulk Edit Employees" (close)="closeBulkEditModal()" [width]="600">
  <form [formGroup]="bulkEditForm" (ngSubmit)="onBulkEditSubmit()">
    <div class="form-container">
      <div class="form-row">
        <kendo-label text="Designation:" class="form-label">
          <kendo-dropdownlist 
            formControlName="designation" 
            [data]="designations" 
            [valuePrimitive]="true" 
            [defaultItem]="'-- Select --'"
            class="form-control">
          </kendo-dropdownlist>
        </kendo-label>
      </div>

      <div class="form-row">
        <kendo-label text="Location:" class="form-label">
          <kendo-dropdownlist 
            formControlName="location" 
            [data]="locations" 
            [valuePrimitive]="true" 
            [defaultItem]="'-- Select --'"
            class="form-control">
          </kendo-dropdownlist>
        </kendo-label>
      </div>

      <div class="form-row">
        <kendo-label text="Billable:" class="form-label">
          <kendo-dropdownlist 
            formControlName="billable" 
            [data]="[{text: '-- Select --', value: ''}, {text: 'Yes', value: 'yes'}, {text: 'No', value: 'no'}]" 
            textField="text" 
            valueField="value"
            class="form-control">
          </kendo-dropdownlist>
        </kendo-label>
      </div>

      <div class="form-row">
        <kendo-label text="Skills:" class="form-label">
          <kendo-multiselect 
            formControlName="skill" 
            [data]="skills" 
            [valuePrimitive]="true" 
            placeholder="Select skills..."
            class="form-control">
          </kendo-multiselect>
        </kendo-label>
      </div>

      <div class="form-row">
        <kendo-label text="Projects:" class="form-label">
          <kendo-multiselect 
            formControlName="project" 
            [data]="projects" 
            [valuePrimitive]="true" 
            placeholder="Select projects..."
            class="form-control">
          </kendo-multiselect>
        </kendo-label>
      </div>

      <div class="form-row">
        <kendo-label text="Managers:" class="form-label">
          <kendo-multiselect 
            formControlName="reportingTo" 
            [data]="managers" 
            [valuePrimitive]="true" 
            placeholder="Select managers..."
            class="form-control">
          </kendo-multiselect>
        </kendo-label>
      </div>

      <div class="form-row">
        <kendo-label text="Date of Joining:" class="form-label">
          <kendo-datepicker 
            formControlName="doj"
            class="form-control">
          </kendo-datepicker>
        </kendo-label>
      </div>

      <div class="form-row">
        <kendo-label text="Remarks:" class="form-label">
          <kendo-textarea 
            formControlName="remarks" 
            [rows]="3"
            class="form-control">
          </kendo-textarea>
        </kendo-label>
      </div>
    </div>

    <div class="dialog-actions">
      <button kendoButton type="submit" [primary]="true" [disabled]="loading">
        Apply Changes
      </button>
      <button kendoButton type="button" (click)="closeBulkEditModal()">
        Cancel
      </button>
    </div>
  </form>
</kendo-dialog>
